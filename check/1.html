
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Cppcheck - HTML report - [project name]</title>
    <link rel="stylesheet" href="style.css">
    <style>
.highlight .hll { background-color: #ffffcc }
.highlight  { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #FF0000; background-color: #FFAAAA } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .o { color: #333333 } /* Operator */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #557799 } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #003388; font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #333399; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #6600EE; font-weight: bold } /* Literal.Number */
.highlight .s { background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #0000CC } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #BB0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #880000; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #FF0000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066BB; font-weight: bold } /* Name.Function */
.highlight .nl { color: #997700; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #007700 } /* Name.Tag */
.highlight .nv { color: #996633 } /* Name.Variable */
.highlight .ow { color: #000000; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #6600EE; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #6600EE; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #005588; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #4400EE; font-weight: bold } /* Literal.Number.Oct */
.highlight .sb { background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #0044DD } /* Literal.String.Char */
.highlight .sd { color: #DD4422 } /* Literal.String.Doc */
.highlight .s2 { background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #666666; font-weight: bold; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { background-color: #eeeeee } /* Literal.String.Interpol */
.highlight .sx { color: #DD2200; background-color: #fff0f0 } /* Literal.String.Other */
.highlight .sr { color: #000000; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #AA6600 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700; font-weight: bold } /* Name.Variable.Global */
.highlight .vi { color: #3333BB } /* Name.Variable.Instance */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */
    </style>
    <script language="javascript">
      function getStyle(el,styleProp) {
        if (el.currentStyle)
          var y = el.currentStyle[styleProp];
        else if (window.getComputedStyle)
          var y = document.defaultView.getComputedStyle(el,null).getPropertyValue(styleProp);
        return y;
      }
      function toggle() {
        var el = this.expandable_content;
        var mark = this.expandable_marker;
        if (el.style.display == "block") {
          el.style.display = "none";
          mark.innerHTML = "[+]";
        } else {
          el.style.display = "block";
          mark.innerHTML = "[-]";
        }
      }
      function init_expandables() {
        var elts = document.getElementsByClassName("expandable");
        for (var i = 0; i < elts.length; i++) {
          var el = elts[i];
          var clickable = el.getElementsByTagName("span")[0];
          var marker = clickable.getElementsByClassName("marker")[0];
          var content = el.getElementsByClassName("content")[0];
          var width = clickable.clientWidth - parseInt(getStyle(content, "padding-left")) - parseInt(getStyle(content, "padding-right"));
          content.style.width = width + "px";
          clickable.expandable_content = content;
          clickable.expandable_marker = marker;
          clickable.onclick = toggle;
        }
      }
    </script>
  </head>
  <body onload="init_expandables()">
      <div id="header">
        <h1>Cppcheck report - [project name]: src/generation/generator.hpp </h1>
      </div>
      <div id="menu" dir="rtl">
       <p id="filename"><a href="index.html">Defects:</a> generator.hpp</p>
<a href='1.html#line-72'> noExplicitConstructor 72</a>
      </div>
      <div id="content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238</pre></div></td><td class="code"><div class="highlight"><pre><a name="line-1"></a><span class="cm">/**</span>
<a name="line-2"></a><span class="cm"> * \file   generation/generator.hpp</span>
<a name="line-3"></a><span class="cm"> * \brief  Define a class allowing to generate an entire level.</span>
<a name="line-4"></a><span class="cm"> */</span>
<a name="line-5"></a>
<a name="line-6"></a><span class="cp">#pragma once</span>
<a name="line-7"></a>
<a name="line-8"></a><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp"></span>
<a name="line-9"></a><span class="cp">#include</span> <span class="cpf">&lt;chrono&gt;</span><span class="cp"></span>
<a name="line-10"></a><span class="cp">#include</span> <span class="cpf">&lt;cstdint&gt;</span><span class="cp"></span>
<a name="line-11"></a><span class="cp">#include</span> <span class="cpf">&lt;list&gt;</span><span class="cp"></span>
<a name="line-12"></a><span class="cp">#include</span> <span class="cpf">&lt;memory&gt;</span><span class="cp"></span>
<a name="line-13"></a><span class="cp">#include</span> <span class="cpf">&lt;mutex&gt;</span><span class="cp"></span>
<a name="line-14"></a><span class="cp">#include</span> <span class="cpf">&lt;queue&gt;</span><span class="cp"></span>
<a name="line-15"></a><span class="cp">#include</span> <span class="cpf">&lt;set&gt;</span><span class="cp"></span>
<a name="line-16"></a><span class="cp">#include</span> <span class="cpf">&lt;thread&gt;</span><span class="cp"></span>
<a name="line-17"></a><span class="cp">#include</span> <span class="cpf">&lt;tuple&gt;</span><span class="cp"></span>
<a name="line-18"></a><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp"></span>
<a name="line-19"></a>
<a name="line-20"></a><span class="cp">#include</span> <span class="cpf">&quot;pattern.hpp&quot;</span><span class="cp"></span>
<a name="line-21"></a><span class="cp">#include</span> <span class="cpf">&quot;room.hpp&quot;</span><span class="cp"></span>
<a name="line-22"></a><span class="cp">#include</span> <span class="cpf">&quot;space.hpp&quot;</span><span class="cp"></span>
<a name="line-23"></a>
<a name="line-24"></a><span class="cp">#include</span> <span class="cpf">&quot;../map.hpp&quot;</span><span class="cp"></span>
<a name="line-25"></a><span class="cp">#include</span> <span class="cpf">&quot;../entity.hpp&quot;</span><span class="cp"></span>
<a name="line-26"></a>
<a name="line-27"></a>
<a name="line-28"></a><span class="c1">// Number of chunks that will be generated on border of requested chunks</span>
<a name="line-29"></a><span class="k">constexpr</span> <span class="kt">int</span> <span class="n">GEN_BORDER</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<a name="line-30"></a>
<a name="line-31"></a><span class="cm">/**</span>
<a name="line-32"></a><span class="cm"> * \brief A level, with the map and the entities</span>
<a name="line-33"></a><span class="cm"> */</span>
<a name="line-34"></a><span class="k">struct</span> <span class="n">Level</span>
<a name="line-35"></a><span class="p">{</span>
<a name="line-36"></a>    <span class="n">Map</span> <span class="n">map</span><span class="p">;</span>
<a name="line-37"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Entity</span><span class="o">&gt;&gt;</span> <span class="n">entities</span><span class="p">;</span>
<a name="line-38"></a><span class="p">};</span>
<a name="line-39"></a>
<a name="line-40"></a><span class="cm">/**</span>
<a name="line-41"></a><span class="cm"> * \brief  An object that can generate chunks of the map.</span>
<a name="line-42"></a><span class="cm"> *</span>
<a name="line-43"></a><span class="cm"> * \section Features</span>
<a name="line-44"></a><span class="cm"> *   The generator can answer to chunk requests :</span>
<a name="line-45"></a><span class="cm"> *    - given a coordinate (not necessary positive), get the map</span>
<a name="line-46"></a><span class="cm"> *    - given a coordinate (not necessary positive), get the entities</span>
<a name="line-47"></a><span class="cm"> *   It is also possible to ask to pregenerate a radius and to ask what are the already generated but not requested chunks.</span>
<a name="line-48"></a><span class="cm"> *</span>
<a name="line-49"></a><span class="cm"> * \section Behaviour</span>
<a name="line-50"></a><span class="cm"> *   The generator keeps up to date a list of rooms. Creating new rooms always follow the same pattern:</span>
<a name="line-51"></a><span class="cm"> *    - generate rooms shapes and place them at an arbitrary position</span>
<a name="line-52"></a><span class="cm"> *    - separate rooms to avoid them from collapsing</span>
<a name="line-53"></a><span class="cm"> *    - add hallways between rooms (it generates new rooms)</span>
<a name="line-54"></a><span class="cm"> *    - add entities on rooms</span>
<a name="line-55"></a><span class="cm"> *    - draw rooms on a cached map</span>
<a name="line-56"></a><span class="cm"> *   If the map has to be finite, theses steps will only be executed once, thus the generator will only have to answer using his cached map.</span>
<a name="line-57"></a><span class="cm"> */</span>
<a name="line-58"></a><span class="k">class</span> <span class="nc">Generator</span>
<a name="line-59"></a><span class="p">{</span>
<a name="line-60"></a><span class="k">public</span><span class="o">:</span>
<a name="line-61"></a>    <span class="cm">/**</span>
<a name="line-62"></a><span class="cm">     * \brief    Construct a generator doing nothing.</span>
<a name="line-63"></a><span class="cm">     */</span>
<a name="line-64"></a>    <span class="n">Generator</span><span class="p">();</span>
<a name="line-65"></a>
<a name="line-66"></a>    <span class="cm">/**</span>
<a name="line-67"></a><span class="cm">     * \brief    Main constructor. Initialisation of parameters.</span>
<a name="line-68"></a><span class="cm">     *</span>
<a name="line-69"></a><span class="cm">     * \param    parameters The configuration of the map generation.</span>
<a name="line-70"></a><span class="cm">     * \warning  Note that we may need to use the generator exacly with the same queries to get the same map.</span>
<a name="line-71"></a><span class="cm">     */</span>
<a name="line-72"></a><span class="hll">    <span class="n">Generator</span><span class="p">(</span><span class="k">const</span> <span class="n">GenerationMode</span><span class="o">&amp;</span> <span class="n">parameters</span><span class="p">);</span><div class='verbose expandable'><span class='error2'>&lt;--- Class 'Generator' has a constructor with 1 argument that is not explicit. <span class='marker'>[+]</span></span><div class='content'>Class &apos;Generator&apos; has a constructor with 1 argument that is not explicit. Such constructors should in general be explicit for type safety reasons. Using the explicit keyword in the constructor means some mistakes when using the class can be avoided.</div></div>
</span><a name="line-73"></a>
<a name="line-74"></a>    <span class="c1">// a copy would need to restart a thread, and is very heavy</span>
<a name="line-75"></a>    <span class="n">Generator</span><span class="p">(</span><span class="n">Generator</span><span class="o">&amp;&amp;</span><span class="p">)</span> <span class="o">=</span> <span class="k">delete</span><span class="p">;</span>
<a name="line-76"></a>    <span class="n">Generator</span><span class="p">(</span><span class="k">const</span> <span class="n">Generator</span><span class="o">&amp;</span><span class="p">)</span> <span class="o">=</span> <span class="k">delete</span><span class="p">;</span>
<a name="line-77"></a>
<a name="line-78"></a>    <span class="cm">/**</span>
<a name="line-79"></a><span class="cm">     * \brief    Stop generation and destruct the generator.</span>
<a name="line-80"></a><span class="cm">     */</span>
<a name="line-81"></a>    <span class="o">~</span><span class="n">Generator</span><span class="p">();</span>
<a name="line-82"></a>
<a name="line-83"></a>    <span class="cm">/**</span>
<a name="line-84"></a><span class="cm">     * \brief   Get the chunk of coordinates (x, y).</span>
<a name="line-85"></a><span class="cm">     * \param   x x-coordinate of the chunk.</span>
<a name="line-86"></a><span class="cm">     * \param   y y-coordinate of the chunk.</span>
<a name="line-87"></a><span class="cm">     * \return  The content of the queried chunk.</span>
<a name="line-88"></a><span class="cm">     */</span>
<a name="line-89"></a>    <span class="n">Chunk</span> <span class="nf">getChunkCells</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">);</span>
<a name="line-90"></a>
<a name="line-91"></a>    <span class="cm">/**</span>
<a name="line-92"></a><span class="cm">     * \brief   Get the list of all cached chunks not requested so far.</span>
<a name="line-93"></a><span class="cm">     * \return  A vector of the id of each not-requested chunk.</span>
<a name="line-94"></a><span class="cm">     */</span>
<a name="line-95"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">getCachedChunks</span><span class="p">();</span>
<a name="line-96"></a>
<a name="line-97"></a>    <span class="cm">/**</span>
<a name="line-98"></a><span class="cm">     * \brief Get the enties initially placed on the chunk of coordinates (x, y).</span>
<a name="line-99"></a><span class="cm">     * \param   x x-coordinate of the chunk.</span>
<a name="line-100"></a><span class="cm">     * \param   y y-coordinate of the chunk.</span>
<a name="line-101"></a><span class="cm">     * \return  The list of the entities initially placed on the queried chunk.</span>
<a name="line-102"></a><span class="cm">     */</span>
<a name="line-103"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Entity</span><span class="o">&gt;&gt;</span> <span class="n">getChunkEntities</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">);</span>
<a name="line-104"></a>
<a name="line-105"></a>    <span class="cm">/**</span>
<a name="line-106"></a><span class="cm">     * \brief  Indicate to generate around a chunk.</span>
<a name="line-107"></a><span class="cm">     * \param  y         y-coordinate of the chunk.</span>
<a name="line-108"></a><span class="cm">     * \param  x         x-coordinate of the chunk.</span>
<a name="line-109"></a><span class="cm">     * \param  radius    The radius of a square of center {x, y}.</span>
<a name="line-110"></a><span class="cm">     * \param  priority  If set to true this chunk is generated before other chunks without priority.</span>
<a name="line-111"></a><span class="cm">     * \note   This function might only be used for infinite generation since the whole map is generated at creation for finite generation.</span>
<a name="line-112"></a><span class="cm">     *</span>
<a name="line-113"></a><span class="cm">     * It means that the generated square has a diagonal from {x-radius, y-radius} to {x+radius, y+radius}.</span>
<a name="line-114"></a><span class="cm">     * It won&#39;t generate a chunk if it has already been generated.</span>
<a name="line-115"></a><span class="cm">     */</span>
<a name="line-116"></a>    <span class="kt">void</span> <span class="nf">preGenerateRadius</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">radius</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">priority</span> <span class="o">=</span> <span class="nb">false</span><span class="p">);</span>
<a name="line-117"></a>
<a name="line-118"></a>    <span class="cm">/**</span>
<a name="line-119"></a><span class="cm">     * \brief  Same as preGenerateRadius, but the call will only end when the generation is over. Thus the priority used.</span>
<a name="line-120"></a><span class="cm">     */</span>
<a name="line-121"></a>    <span class="kt">void</span> <span class="nf">generateRadius</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">radius</span><span class="p">);</span>
<a name="line-122"></a>
<a name="line-123"></a>
<a name="line-124"></a><span class="k">private</span><span class="o">:</span>
<a name="line-125"></a>    <span class="cm">/**</span>
<a name="line-126"></a><span class="cm">     * \brief   Check if the cells of a chunk are locked.</span>
<a name="line-127"></a><span class="cm">     * \param   x x-coordinate of the chunk.</span>
<a name="line-128"></a><span class="cm">     * \param   y y-coordinate of the chunk.</span>
<a name="line-129"></a><span class="cm">     * \return  Wether the chunk could or couldn&#39;t change.</span>
<a name="line-130"></a><span class="cm">     */</span>
<a name="line-131"></a>    <span class="kt">bool</span> <span class="n">isLockedChunk</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">);</span>
<a name="line-132"></a>
<a name="line-133"></a>    <span class="cm">/**</span>
<a name="line-134"></a><span class="cm">     * \brief  Assert that a chunk must now be locked.</span>
<a name="line-135"></a><span class="cm">     * \param  x x-coordinate of the chunk.</span>
<a name="line-136"></a><span class="cm">     * \param  y y-coordinate of the chunk.</span>
<a name="line-137"></a><span class="cm">     */</span>
<a name="line-138"></a>    <span class="kt">void</span> <span class="nf">setLockedChunk</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">);</span>
<a name="line-139"></a>
<a name="line-140"></a>    <span class="cm">/**</span>
<a name="line-141"></a><span class="cm">     * \brief   Check if rooms have already been added to the chunk.</span>
<a name="line-142"></a><span class="cm">     * \param   x x-coordinate of the chunk.</span>
<a name="line-143"></a><span class="cm">     * \param   y y-coordinate of the chunk.</span>
<a name="line-144"></a><span class="cm">     * \return  True if the chunk is already filled with rooms.</span>
<a name="line-145"></a><span class="cm">     */</span>
<a name="line-146"></a>    <span class="kt">bool</span> <span class="nf">isFilledChunk</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">);</span>
<a name="line-147"></a>
<a name="line-148"></a>    <span class="cm">/**</span>
<a name="line-149"></a><span class="cm">     * \brief  Assert that a chunk has been filled.</span>
<a name="line-150"></a><span class="cm">     * \param  x x-coordinate of the chunk.</span>
<a name="line-151"></a><span class="cm">     * \param  y y-coordinate of the chunk.</span>
<a name="line-152"></a><span class="cm">     */</span>
<a name="line-153"></a>    <span class="kt">void</span> <span class="nf">setFilledChunk</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">);</span>
<a name="line-154"></a>
<a name="line-155"></a>    <span class="cm">/**</span>
<a name="line-156"></a><span class="cm">     * \brief  Generate some rooms centered on given chunck.</span>
<a name="line-157"></a><span class="cm">     * \param  x x-coordinate of the center chunk.</span>
<a name="line-158"></a><span class="cm">     * \param  y y-coordinate of the center chunk.</span>
<a name="line-159"></a><span class="cm">     * \param  n number of rooms to generate.</span>
<a name="line-160"></a><span class="cm">     * \warn   This can generate less than n rooms.</span>
<a name="line-161"></a><span class="cm">     */</span>
<a name="line-162"></a>    <span class="kt">void</span> <span class="nf">addRooms</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">);</span>
<a name="line-163"></a>
<a name="line-164"></a>    <span class="cm">/**</span>
<a name="line-165"></a><span class="cm">     * \brief  Ensure connexity of the level.</span>
<a name="line-166"></a><span class="cm">     * Update room_links and create new hallways between rooms.</span>
<a name="line-167"></a><span class="cm">     */</span>
<a name="line-168"></a>    <span class="kt">void</span> <span class="nf">updateLinks</span><span class="p">();</span>
<a name="line-169"></a>
<a name="line-170"></a>    <span class="cm">/**</span>
<a name="line-171"></a><span class="cm">     * \brief  Specify that a room has been added to the map.</span>
<a name="line-172"></a><span class="cm">     * \param  room The index of the room in `rooms`</span>
<a name="line-173"></a><span class="cm">     * This method must be called each time a room is added to the map.</span>
<a name="line-174"></a><span class="cm">     */</span>
<a name="line-175"></a>    <span class="kt">void</span> <span class="nf">registerRoom</span><span class="p">(</span><span class="kt">size_t</span> <span class="n">room</span><span class="p">);</span>
<a name="line-176"></a>
<a name="line-177"></a>    <span class="cm">/**</span>
<a name="line-178"></a><span class="cm">     * \brief  Loop that generates any chunk given in the list.</span>
<a name="line-179"></a><span class="cm">     */</span>
<a name="line-180"></a>    <span class="kt">void</span> <span class="nf">generationLoop</span><span class="p">();</span>
<a name="line-181"></a>
<a name="line-182"></a>
<a name="line-183"></a>    <span class="c1">///&lt; Parameters for the generation</span>
<a name="line-184"></a>    <span class="n">GenerationMode</span> <span class="n">parameters</span><span class="p">;</span>
<a name="line-185"></a>
<a name="line-186"></a>    <span class="c1">///&lt; Thread that actualy generates</span>
<a name="line-187"></a>    <span class="n">std</span><span class="o">::</span><span class="kr">thread</span> <span class="n">generating_thread</span><span class="p">;</span>
<a name="line-188"></a>
<a name="line-189"></a>    <span class="c1">///&lt; Wether the process has to continue</span>
<a name="line-190"></a>    <span class="kt">bool</span> <span class="n">do_generate</span><span class="p">;</span>
<a name="line-191"></a>
<a name="line-192"></a>    <span class="c1">///&lt; A list of chunks we need to generate</span>
<a name="line-193"></a>    <span class="c1">// This list is read from its front, thus, most important tasks are put in the front</span>
<a name="line-194"></a>    <span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">to_generate</span><span class="p">;</span>
<a name="line-195"></a>
<a name="line-196"></a>    <span class="c1">///&lt; Lock for to_generate</span>
<a name="line-197"></a>    <span class="n">std</span><span class="o">::</span><span class="n">mutex</span> <span class="n">to_generate_lock</span><span class="p">;</span>
<a name="line-198"></a>
<a name="line-199"></a>    <span class="c1">///&lt; Set of chunk we don&#39;t wan&#39;t to modify anymore</span>
<a name="line-200"></a>    <span class="n">std</span><span class="o">::</span><span class="n">set</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">locked</span><span class="p">;</span>
<a name="line-201"></a>
<a name="line-202"></a>    <span class="c1">///&lt; Lock for locked</span>
<a name="line-203"></a>    <span class="n">std</span><span class="o">::</span><span class="n">mutex</span> <span class="n">locked_lock</span><span class="p">;</span>
<a name="line-204"></a>
<a name="line-205"></a>    <span class="c1">///&lt; Set of chunks that have already been built so far</span>
<a name="line-206"></a>    <span class="n">std</span><span class="o">::</span><span class="n">set</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">filled</span><span class="p">;</span>
<a name="line-207"></a>
<a name="line-208"></a>    <span class="c1">///&lt; Lock for filled</span>
<a name="line-209"></a>    <span class="n">std</span><span class="o">::</span><span class="n">mutex</span> <span class="n">filled_lock</span><span class="p">;</span>
<a name="line-210"></a>
<a name="line-211"></a>    <span class="c1">///&lt; List of rooms generated so far</span>
<a name="line-212"></a>    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Room</span><span class="o">&gt;</span> <span class="n">rooms</span><span class="p">;</span>
<a name="line-213"></a>
<a name="line-214"></a>    <span class="c1">///&lt; A cached version of the map we generated so far</span>
<a name="line-215"></a>    <span class="n">Map</span> <span class="n">cached_map</span><span class="p">;</span>
<a name="line-216"></a>
<a name="line-217"></a>    <span class="c1">///&lt; A cached version of entities for each chunk</span>
<a name="line-218"></a>    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Entity</span><span class="o">&gt;&gt;&gt;</span> <span class="n">cached_entities</span><span class="p">;</span>
<a name="line-219"></a>
<a name="line-220"></a>    <span class="c1">///&lt; Lock for the cache</span>
<a name="line-221"></a>    <span class="n">std</span><span class="o">::</span><span class="n">mutex</span> <span class="n">cache_lock</span><span class="p">;</span>
<a name="line-222"></a>
<a name="line-223"></a>    <span class="c1">///&lt; Keep track of connections between rooms</span>
<a name="line-224"></a>    <span class="n">std</span><span class="o">::</span><span class="n">set</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">,</span> <span class="kt">size_t</span><span class="o">&gt;&gt;</span> <span class="n">room_links</span><span class="p">;</span>
<a name="line-225"></a>
<a name="line-226"></a>
<a name="line-227"></a>    <span class="cm">/**</span>
<a name="line-228"></a><span class="cm">     * \brief  Serialisation of current state of the generation.</span>
<a name="line-229"></a><span class="cm">     * The parameters of the generations won&#39;t be saved.</span>
<a name="line-230"></a><span class="cm">     */</span>
<a name="line-231"></a>    <span class="k">friend</span> <span class="n">std</span><span class="o">::</span><span class="n">ostream</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">ostream</span><span class="o">&amp;</span> <span class="n">stream</span><span class="p">,</span> <span class="n">Generator</span><span class="o">&amp;</span> <span class="n">generator</span><span class="p">);</span>
<a name="line-232"></a>
<a name="line-233"></a>    <span class="cm">/**</span>
<a name="line-234"></a><span class="cm">     * \brief  Serialisation of current state of the generation.</span>
<a name="line-235"></a><span class="cm">     * The parameters of the generations won&#39;t be saved.</span>
<a name="line-236"></a><span class="cm">     */</span>
<a name="line-237"></a>    <span class="k">friend</span> <span class="n">std</span><span class="o">::</span><span class="n">istream</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">istream</span><span class="o">&amp;</span> <span class="n">stream</span><span class="p">,</span> <span class="n">Generator</span><span class="o">&amp;</span> <span class="n">generator</span><span class="p">);</span>
<a name="line-238"></a><span class="p">};</span>
</pre></div>
</td></tr></table>
      </div>
      <div id="footer">
        <p>
         Cppcheck 1.72 - a tool for static C/C++ code analysis</br>
         </br>
         Internet: <a href="http://cppcheck.sourceforge.net">http://cppcheck.sourceforge.net</a></br>
         IRC: <a href="irc://irc.freenode.net/cppcheck">irc://irc.freenode.net/cppcheck</a></br>
        <p>
      </div>
  </body>
</html>
