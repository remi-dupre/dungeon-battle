sudo: required

services:
  - docker

language: cpp

before_install:
 - docker run -d --name artful -v $(pwd):/travis ubuntu:artful tail -f /dev/null
 - docker ps

install:
 - docker exec -t artful bash -c "apt-get update"
 - docker exec -t artful bash -c "apt-get install -y --no-install-recommends build-essential"
 - docker exec -t artful bash -c "apt-get install -y --no-install-recommends libsfml-dev"
 - docker exec -t artful bash -c "apt-get install -y --no-install-recommends doxygen"
 - docker exec -t artful bash -c "apt-get install -y --no-install-recommends cxxtest cppcheck"

script:
 - docker exec -t artful bash -c "cd /travis;
   make doc CXX=g++-7";
 - docker exec -t artful bash -c "cd /travis;
   make cppcheck-html CHECK_DIR=doc/check CXX=g++-7";
 - docker exec -t artful bash -c "cd /travis;
   make debug CXX=g++-7;"
 - docker exec -t artful bash -c "cd /travis;
   make test CXX=g++-7;"

deploy:
  name: Travis Documentation Generation
  provider: pages
  local_dir: doc/html
  skip_cleanup: true
  github_token: $GITHUB_TOKEN
  on:
    branch: master
